<!DOCTYPE html>
<html lang="en">
    <head>
    <title>Utopian</title>
        <meta charset="utf-8">
        <!-- user screen, use device scren, dont zoomin or out -->
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB" crossorigin="anonymous">
        <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='main.css') }}">
        <!-- <link rel="stylesheet" type = "text/css" href="{{url_for('static',filename='style_sheet.css')}}"/> -->
        <!-- <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script> -->
        <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCg6SzshqdaxNJX0FupvjX177MX7V71X48"></script>

        
        <style>
            .jumbotron{
                /* background- */
                background-image: url({{ url_for('static', filename='image/rbf.jpg') }});
                background-size: cover;  
            }

                    
            body
            {
                font-family: 'Open Sans', sans-serif;
            }

            .fb-profile img.fb-image-lg{
                z-index: 0;
                width: 100%;  
                margin-bottom: 10px;
            }

            .fb-image-profile
            {
                margin: -90px 10px 0px 50px;
                z-index: 9;
                width: 20%; 
            }

            @media (max-width:768px)
            {
                
            .fb-profile-text>h1{
                font-weight: 700;
                font-size:16px;
            }

            .fb-image-profile
            {
                margin: -45px 10px 0px 25px;
                z-index: 9;
                width: 20%; 
            }
        }

        /* #sidebar{
        position: absolute;
        right: 100px;
        align-content: center;
        } */

        </style>
</head>

<!-- {% with messages = get_flashed_messages(with_categories=true) %}
{% if messages %}
  <!-- {% for category, message in messages %} 
    <div class="alert alert-{{ category }}">
      {{ message }}
    </div>
  {% endfor %}
{% endif %}
{% endwith %} -->

<main role="main" class="container">
        <div class="row">
          <div class="col-md-8">
            {% with messages = get_flashed_messages(with_categories=true) %}
              {% if messages %}
                {% for category, message in messages %}
                  <div class="alert alert-{{ category }}">
                    {{ message }}
                  </div>
                {% endfor %}
              {% endif %}
            {% endwith %}
            {% block body %}{% endblock %}
          </div>
          <!-- <div class="col-md-4">
            <div class="content-section">
              <h3>Our Sidebar</h3>
              <p class='text-muted'>You can put any information here you'd like.
                <ul class="list-group">
                  <li class="list-group-item list-group-item-light">Latest Posts</li>
                  <li class="list-group-item list-group-item-light">Announcements</li>
                  <li class="list-group-item list-group-item-light">Calendars</li>
                  <li class="list-group-item list-group-item-light">etc</li>
                </ul>
              </p>
            </div>
          </div> -->



          {% if current_user.is_authenticated %}
            <div class="col-md-4" id='sidebar'>
            <div class="content-section">
              <h3>Our Sidebar</h3>
              <p class='text-muted'>You can put any information here you'd like.
                <ul class="list-group">
                  <a class="list-group-item list-group-item-light" href="{{url_for('new_post',username=username)}}">New Posts</a>
                  <a class="list-group-item list-group-item-light" href="{{url_for('user_posts', username = current_user.username)}}">My Posts</a>
                  <div class="content-section">
            
                  </div>
                  <li class="list-group-item list-group-item-light">etc</li>
                </ul>
              </p>

              <p>Click the button to get your coordinates.</p>


<!-- <button onclick="getLocation()">Try It</button> -->

<p id="coordi"></p>
<a id="location"></a>
<script>
window.onload=getLocation();
// window.onload=getReverseGeocodingData(position.coords.latitude,position.coords.longitude);
var x = document.getElementById("coordi");
var y = document.getElementById("location");

function getLocation() {
    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(showPosition);
    } else { 
        x.innerHTML = "Geolocation is not supported by this browser.";
    }
}

function showPosition(position) {
    x.innerHTML = "Latitude: " + position.coords.latitude + 
    "<br>Longitude: " + position.coords.longitude;

    	if (navigator.geolocation) {
  navigator.geolocation.getCurrentPosition(function(position) {
    var geocoder = new google.maps.Geocoder;
    var point = new google.maps.LatLng(
        position.coords.latitude, position.coords.longitude);
    geocoder.geocode({'latLng': point}, function (locations, status) {
      if (status == google.maps.GeocoderStatus.OK) {
        for (var location of locations) {
          if ($.inArray('locality', location.types) != -1) {
            y.innerHTML = 'Your location is: ' + location.formatted_address;
            // document.write(<a>Find what's fun near me!</a>)
            break;
          }
        };
      }
    });
  });
}

// var geocoder;

// function initialize() {
//   geocoder = new google.maps.Geocoder();
// }

// function codeLatLng(lat, lng) {
//   var latlng = new google.maps.LatLng(lat, lng);
//   geocoder.geocode({
//     'latLng': latlng
//   }, function (results, status) {
//     if (status === google.maps.GeocoderStatus.OK) {
//       if (results[1]) {
//         console.log(results[1]);
//       } else {
//         alert('No results found');
//       }
//     } else {
//       alert('Geocoder failed due to: ' + status);
//     }
//   });
// }

// google.maps.event.addDomListener(window, 'load', initialize);

// codeLatLng(position.coords.latitude, position.coords.longitude);
}



function getReverseGeocodingData(lat, lng) {
    var latlng = new google.maps.LatLng(lat, lng);
    // This is making the Geocode request
    var geocoder = new google.maps.Geocoder();
    geocoder.geocode({ 'latLng': latlng }, function (results, status) {
        if (status !== google.maps.GeocoderStatus.OK) {
            alert(status);
        }
        // This is checking to see if the Geoeode Status is OK before proceeding
        if (status == google.maps.GeocoderStatus.OK) {
            console.log(results);
            var address = (results[0].formatted_address);
        }
    });
}
    // lat = position.coords.latitude;
    // lng = position.coords.longitude;
    // var latlng = new google.maps.LatLng(lat, lng);
    // // This is making the Geocode request
    // var geocoder = new google.maps.Geocoder();
    // geocoder.geocode({ 'latLng': latlng }, function (results, status) {
    //     if (status !== google.maps.GeocoderStatus.OK) {
    //         alert(status);
    //     }
    //     // This is checking to see if the Geoeode Status is OK before proceeding
    //     if (status == google.maps.GeocoderStatus.OK) {
    //         console.log(results);
    //         var address = (results[0].formatted_address);
    //         x.innerHTML = 'Your location: '+ address;
    //     }
    // });
    

// }
</script>
            </div>
            </div>
        {%endif%}
        </div>
      </main>

 
        <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js" integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T" crossorigin="anonymous"></script>
        <!-- <script src="https://maps.googleapis.com/maps/api/js?libraries=places"></script> -->
        <script>
            $('#location.button').click(function(){
              if(navigator.geolocation)
                navigator.geolocation.getCurrentPosition(function(position){
                  console.log(postion);
                });
              else
                console.log('geolocation is not supported')
            });
          </script>

<!-- <script>
    // Call Geocode
    //geocode();

    // Get location form
    var locationForm = document.getElementById('searchbar');

    // Listen for submiot
    locationForm.addEventListener('submit', geocode);

    function geocode(e){
      // Prevent actual submit
      e.preventDefault();

      var location = document.getElementById('location-input').value;

      axios.get('https://maps.googleapis.com/maps/api/geocode/json',{
        params:{
          address:location,
          key:'AIzaSyCg6SzshqdaxNJX0FupvjX177MX7V71X48'
        }
      })
      .then(function(response){
        // Log full response
        console.log(response);

        // Formatted Address
        var formattedAddress = response.data.results[0].formatted_address;
        var formattedAddressOutput = `
          <ul class="list-group">
            <li class="list-group-item">${formattedAddress}</li>
          </ul>
        `;

        // Address Components
        var addressComponents = response.data.results[0].address_components;
        var addressComponentsOutput = '<ul class="list-group">';
        for(var i = 0;i < addressComponents.length;i++){
          addressComponentsOutput += `
            <li class="list-group-item"><strong>${addressComponents[i].types[0]}</strong>: ${addressComponents[i].long_name}</li>
          `;
        }
        addressComponentsOutput += '</ul>';

        // Geometry
        var lat = response.data.results[0].geometry.location.lat;
        var lng = response.data.results[0].geometry.location.lng;
        var geometryOutput = `
          <ul class="list-group">
            <li class="list-group-item"><strong>Latitude</strong>: ${lat}</li>
            <li class="list-group-item"><strong>Longitude</strong>: ${lng}</li>
          </ul>
        `;

        // Output to app
        document.getElementById('formatted-address').innerHTML = formattedAddressOutput;
        document.getElementById('address-components').innerHTML = addressComponentsOutput;
        document.getElementById('geometry').innerHTML = geometryOutput;
      })
      .catch(function(error){
        console.log(error);
      });
    }
  </script> -->
</html>